<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Consulta 10x10 Ajuste Profissional</title>

<style>
body{
  font-family: Arial, Helvetica, sans-serif;
  background:#eee;
  margin:0;
}

/* ===== TOPO FIXO ===== */
.topo-fixo{
  position:sticky;
  top:0;
  background:#fff;
  padding:20px;
  text-align:center;
  border-bottom:1px solid #ccc;
  z-index:10;
}

.topo-fixo h2{
  margin:0 0 15px 0;
}

.topo-fixo input{
  padding:10px;
  width:380px;
  font-size:16px;
  max-width:90%;
}

.topo-fixo button{
  padding:10px 18px;
  margin:8px 4px 0 4px;
  font-size:15px;
  cursor:pointer;
}

/* ===== ÁREA DA IMAGEM ===== */
.area-canvas{
  text-align:center;
  padding:30px 20px;
}

canvas{
  margin-top:20px;
}
</style>
</head>

<body>

<div class="topo-fixo">
  <h2>Consulta de Adaptações – 10×10 cm</h2>
  <input id="busca" placeholder="Ex: A02, A30, Samsung A20">
  <br>
  <button onclick="buscar()">Buscar</button>
  <button onclick="baixar()">Baixar PNG</button>
</div>

<div class="area-canvas">
  <canvas id="canvas" width="1181" height="1181"></canvas>
</div>

<script>
const cores = {
  samsung:{ fundo:"#1428a0", texto:"#fff" },
  motorola:{ fundo:"#001526", texto:"#fff" },
  xiaomi:{ fundo:"#ff6a08", texto:"#000" },
  apple:{ fundo:"#000", texto:"#fff" }
};

const dados = [{
  marca:"Samsung",
  modelo:"A02",
  adaptacoes:[
    "Samsung A02S","Samsung A03","Samsung A03S","Samsung A03 Core",
    "Samsung A04","Samsung A04S","Samsung A04E","Samsung A12",
    "Samsung M23","Samsung A70",
    "Motorola E7","Motorola E7 Power",
    "Xiaomi 9A","Xiaomi 9A Sport","Xiaomi 9i","Xiaomi 9C"
  ]
}];

const norm = t => t.toLowerCase().replace(/\s+/g,"");

function buscar(){
  const termo = norm(document.getElementById("busca").value);
  const achado = dados.find(d =>
    norm(d.modelo).includes(termo) ||
    d.adaptacoes.some(a=>norm(a).includes(termo))
  );
  if(!achado) return;
  gerarImagem(achado);
}

/* ===== FUNÇÃO RETÂNGULO ARREDONDADO ===== */
function roundRect(ctx, x, y, w, h, r){
  ctx.beginPath();
  ctx.moveTo(x+r, y);
  ctx.lineTo(x+w-r, y);
  ctx.quadraticCurveTo(x+w, y, x+w, y+r);
  ctx.lineTo(x+w, y+h-r);
  ctx.quadraticCurveTo(x+w, y+h, x+w-r, y+h);
  ctx.lineTo(x+r, y+h);
  ctx.quadraticCurveTo(x, y+h, x, y+h-r);
  ctx.lineTo(x, y+r);
  ctx.quadraticCurveTo(x, y, x+r, y);
  ctx.closePath();
}

function gerarImagem(d){
  const c = canvas;
  const ctx = c.getContext("2d");
  const est = cores[d.marca.toLowerCase()] || {fundo:"#fff",texto:"#000"};

  /* FUNDO */
  ctx.fillStyle = est.fundo;
  ctx.fillRect(0,0,c.width,c.height);

  /* BORDAS */
  const b = 25;
  ctx.fillStyle="#0051ff";
  ctx.fillRect(0,0,c.width,b);
  ctx.fillRect(0,0,b,c.height);
  ctx.fillStyle="#ff7a00";
  ctx.fillRect(0,c.height-b,c.width,b);
  ctx.fillRect(c.width-b,0,b,c.height);

  ctx.textAlign="center";
  ctx.fillStyle=est.texto;

  let y = b + 70;

  /* ===== CAIXA DA LOGO ===== */
  const logo = new Image();
  logo.src = `logo/${d.marca.toLowerCase()}.png`;

  const boxW = 420;
  const boxH = 130;
  const boxX = (c.width - boxW)/2;
  const boxY = y - 50;

  /* Sombra */
  ctx.shadowColor="rgba(0,0,0,0.35)";
  ctx.shadowBlur=18;
  ctx.shadowOffsetY=8;

  ctx.fillStyle="#fff";
  roundRect(ctx, boxX, boxY, boxW, boxH, 28);
  ctx.fill();

  ctx.shadowColor="transparent";

  logo.onload = ()=>{
    const imgW = boxW - 80;
    const imgH = logo.height * (imgW / logo.width);
    ctx.drawImage(
      logo,
      boxX + (boxW-imgW)/2,
      boxY + (boxH-imgH)/2,
      imgW,
      imgH
    );
  };

  y += 140;

  /* ===== TÍTULO (SOMENTE MODELO) ===== */
  let titulo = d.modelo;
  let tamanho = 130;
  do{
    ctx.font = `bold ${tamanho}px Arial`;
    tamanho--;
  }while(ctx.measureText(titulo).width > c.width - 120);

  ctx.fillText(titulo,c.width/2,y);

  y+=140;

  ctx.font="bold 60px Arial";
  ctx.fillText("Adaptações:",c.width/2,y);

  y+=80;

  let fonte = 54;
  const areaAltura = c.height - y - b - 20;
  let linhasPorCol;

  do{
    fonte--;
    linhasPorCol = Math.floor(areaAltura / (fonte + 16));
  }while(linhasPorCol * 3 < d.adaptacoes.length && fonte > 36);

  ctx.font = `${fonte}px Arial`;

  const colunas = Math.ceil(d.adaptacoes.length / linhasPorCol);
  const gap = 40;
  const largura = (c.width - 120 - gap*(colunas-1)) / colunas;
  const inicioX = (c.width - ((largura*colunas)+(gap*(colunas-1))))/2;

  d.adaptacoes.forEach((t,i)=>{
    const col = Math.floor(i / linhasPorCol);
    const lin = i % linhasPorCol;
    const x = inicioX + col*(largura+gap) + largura/2;
    const yy = y + lin*(fonte+16);
    ctx.fillText(t,x,yy);
  });
}

function baixar(){
  const a = document.createElement("a");
  a.download="consulta_10x10.png";
  a.href=canvas.toDataURL("image/png");
  a.click();
}
</script>

</body>
</html>

